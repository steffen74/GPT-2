Lat Am Econ Rev (2015) 24:6
DOI 10.1007/s40503-015-0020-z

A robust Bayesian dynamic linear model
for Latin-American economic time series: ‘‘the Mexico
and Puerto Rico cases’’
´
´quene1 • Marta Alvarez2 • Luis Raul Pericchi3
´
Jairo Fu

Received: 29 August 2014 / Revised: 23 May 2015 / Accepted: 1 July 2015 /
Published online: 28 July 2015
Ó The Author(s) 2015. This article is published with open access at Springerlink.com


Economic Latin-American time series variables can be complex with high
frequency data. From a frequentist perspective, techniques for ﬁtting time series
models use a preliminary data-set transformation in order to get stationarity and
therefore important information about the dynamic system can be lost. On the other
hand, from a Bayesian perspective the use of RBDMs with weakly-robust priors for
the observation and state variances has been revolutionary in recent years due to
ﬂexibility for detecting outliers and structural breaks, the straightforward computational techniques based in Markov Chain Monte Carlo (MCMC) and the natural
update from Bayes theorem without a preliminary data-set transformation.
From a frequentist perspective the study of time series with structural changes
has been of far reaching in econometric theory for univariate time series, frequentist
dynamic models, volatility and even ﬁnancial return models. The seminal paper of
Tsay (1988) considers least square techniques and residual variance ratios for
detecting outliers, level shifts and variance changes in univariate time series.
Hansen (2000) introduces a bootstrap method for detecting structural changes in
regressors including structural shifts, polynomial trends and exogenous stochastic
trends for frequentist dynamic econometric models. For volatility models, Vladimir
(2009) uses local chance point analysis to intervals of homogeneity in order to
account possible structural breaks. Fryzlewicz and Rao (2013) propose a method
based in process transformation and binary segmentation for detecting multiple
change points in auto-regressive conditional heteroscedastic models for ﬁnancial
returns.
From a Bayesian perspective in recent years RBDMs for detecting structural
breaks have been proposed as an alternative to the usual Bayesian dynamic models.
Ardia and Hoogerheide (2010) propose a Bayesian generalized autoregressive
conditional heteroscedasticity dynamic model with Student-t innovations with
applications to the R program (R Development Core Team 2015). Polson and Scott
(2011) apply heavy-tailed priors in order to examine historical patterns of return on
´
assets to ﬁnancial time series. Fuquene et al. (2014) propose a new ﬂexible class of
heavy-tailed priors for detecting outliers and structural breaks in Bayesian dynamic
linear models.
However, even though the qualities of RBDMs in the best of our knowledge there
are no application of RBDMs to economic Latin-American variables for detecting
their historic outliers and structural breaks. Therefore, in this work we use the
´
RBDMs proposed by Fuquene et al. (2014) to modelling the historic change points
in Latin-American economic variables from Mexico and Puerto Rico. We use this
methodology because: (1) we can model a considerable variety of dynamic models:
random walk, local linear trend and seasonal or a combination of those models with
weakly-robust priors for the observation and state variances, (2) the computational
schemes can be applied easily for practitioners and (3) using RBDMs allows us to
have posterior inference for the parameters from a Bayesian perspective.
The paper is organized as follows: Section 2 shows the prior variances
in the inﬂation of this country. Section 4 shows local trend and stationary RBDMs
for accounting the abrupt changes in the economic recession periods in Puerto Rico.
Finally we have the conclusions in Sect. 5.

2 Model speciﬁcation
The dynamic linear model (DLM) is speciﬁed (see West and Harrison 1997) by a
Normal prior distribution for the p-dimensional state vector at t ¼ 0 as follows:
h0 $ Np ðm0 ; C0 Þ;

ð1Þ

with the set of equations:
y t ¼ F t ht þ m t
ht ¼ Gt htÀ1 þ xt

mt $ Nm ð0; Vt Þ;
xt $ Np ð0; Wt Þ;

ð2Þ
ð3Þ

with t ¼ 1 : T and where Ft and Gt are known matrices of order p Â p and m Â p
respectively. With mt and xt two independent Gaussian random vectors with mean
zero and known variance Vt and Wt respectively. The observation equation and
state equation are (2) and (3), respectively. A set of prior distributions for the
observation and state variances may be considered in practice. For example in
order to have closed form full conditionals we could use gamma prior densities.
However, in the presence of highly frequency data heavy-tailed priors are the best
alternative. The scaled Beta2 prior for the precision k ¼ 1=s2 is proposed in
´
Fuquene et al. (2014) for modelling the variances (and precisions) in DLMs and
deﬁned as follows:
pðkÞ ¼

Cðq þ pÞ
ðbkÞqÀ1
b
;
CðqÞCðpÞ ð1 þ bkÞpþq

k[0

ð4Þ

where b is the scale parameter. This paper considers the Student-t density coupled
´
with a scaled Beta2 for modelling the observation and state errors (as in Fuquene
et al. 2014) in Latin-American economic time series from Mexico and Puerto Rico.
So, let h $ be a Student-t ðl; s; tÞ where t are the degrees of freedom, l the location
and s the scale of the Student-t density:

 !Àðtþ1Þ=2
k1
1 hÀl 2
2
1þ
pðhjs Þ ¼
; t [ 0; À1\l\1; À1\h\1;
t
s
s
ð5Þ
R1
Cððt þ 1Þ=2Þ
pﬃﬃﬃﬃﬃ . We have that pðhÞ ¼ 0 pðhjs2 Þpðs2 Þds2 and therefore
Cðt=2Þ vp
the marginal prior as follows:

Lat Am Econ Rev (2015) 24:6

bq m=ðh À lÞqþ1=2 2F1ðp þ q; q þ 1=2; ðt þ 1Þ=2 þ p þ q; 1 À bm=ðh À lÞ2 Þ
k1 Beðq þ 1=2; p þ v=2Þ=Beðp; qÞ

if h 6¼ l;
if h ¼ l;

with 2F1(a, b, c, z) the hypergeometric function (see 15.1.1 of Abramowitz and
´
Stegun 1970) and we have that pðhÞ is the Student-t-Beta(t; p; q; b) (see Fuquene
et al. 2014 for the proof of this result). The variances of the RBDM are Student-t1
Betaðt; q; p; bÞ densities (with the Beta2 prior for the precision as k ¼ 1=s2 ). Here
Wt;i denotes the ith diagonal element of Wt;i , i ¼ 1; . . .; n the hierarchical Student-t1
Beta(t; q; p; b) prior can be summarized as follows:
VtÀ1 ¼ ky xy;t ;

À1
Wt;i ¼ kh;i xh;ti ;

ky jq $ Gammaðq; ðbqy ÞÀ1 Þ;

kh;i jq $ Gammaðq; ðbqh;ti ÞÀ1 Þ;

xy;t $ Gammaðt=2; 2=tÞ; xh;ti $ Gammaðt=2; 2=tÞ;
qy $ Gammaðp; 1Þ; qh;ti $ Gammaðp; 1Þ;
For each t, the posterior distribution of the latent variables xy;t and xh;ti is useful in
order to account the outliers and abrupt changes in the economic time series. Values
of xy;t and xh;ti smaller than one indicate possible outliers or abrupt changes
respectively. A Gibbs sampler scheme can be implemented by using the full conditional in closed form of RBDMs (see Appendix 1).
2.1 Illustration RBDM with a toy example: the annual CPI from Puerto
Rico
We consider now the annual Consumer Price Index (CPI) in Puerto in the log-scale
in order to illustrate how a RBDM works. We use a local linear trend model (i.e.,
linear growth model) for ﬁtting the trend and slope of the Consumer CPI in
logarithm scale as follows:
yt ¼ lt þ mt ;

mt $ Nð0; Vt Þ;

lt ¼ ltÀ1 þ ntÀ1 þ xt;1 ; xt;1 $ Nð0; Wt;1 Þ;
nt ¼ ntÀ1 þ xt;2 ; xt;2 $ Nð0; Wt;2 Þ;
with uncorrelated errors mt , xt;1 and xt;2 and where
" 2
#
!
!
rl;t 0
lt
1 1
ht ¼
; Wt ¼
; G¼
;
0 1
nt
0 r2
n;t

F ¼ ½1

ð6Þ

0 :

For this toy example we use a Student-t-Beta2 where p ¼ q ¼ 1, and 1=b ¼
10;000 as is proposed in Pericchi and Perez (2010). We have convergence of all
parameters using 10,000 iterations after a burn-in phase period of 5000 iterations.
Figure 1 displays how by using the RBDM an outlier in the year 2000 is obtained.
The changes in the trend shows the level changes in 1990 and 2001 and the slope
In this section we use a random walk RBDM in order to detect outliers and
structural breaks of the inﬂation in Mexico. We use the monthly logarithm of the
CPI-variations from 1696 to 1983 in order to accounting possible changes in
inﬂation in Mexico during this period such as: (1) The monetary devaluation in 1976
and 1982. (2) The value-added tax imposed in 1980 with the posterior modiﬁcation
in 1983. (3) Some changes in the payment to employees and the increase in gasoline
prices and (4) The modiﬁcation in the economy in Mexico in 1983. The random
walk model RBDM can be written as follows:
y t ¼ ht þ m t ;

mt $ Nð0; Vt Þ;

ht ¼ htÀ1 þ xt ;

ð7Þ

xt;1 $ Nð0; Wt Þ;

0.6
0.6
0.005

0.6
0.0

ωy, t

1.2

−0.005

Residuals

0.0

ωθ2, t

1.2

Slope

0.015 0.025 0.035

0.0

ωθ1, t

1.2

Trend

with the prior speciﬁcation showed in previous Section. We implement the Gibbs
sampling scheme showed in Appendix 1 and from a visual assessment of the Gibbs
output we have that convergence has been achieved in Appendix 2. The ergodic
means are nonetheless pretty stable in the middle of the plots and the decay of the
empirical autocorrelation function is very fast.

1985

1990

1995

2000

2005

2010

Fig. 1 Outliers and structural breaks in the annual logarithm Consumer Price Index in Puerto Rico using
September 1976 and January 1982. These changes likely represent the exchange rate
devaluation in September 1976 and just one month before of the second devaluation
in 1982. On the other hand, in Table 1 the expectations for the latent parameters for
identifying the outliers in the random walk RBDM are presented. The outliers in
January 1980 and January 1983 probably showed the value-added tax imposed and
consequently modiﬁed in those dates with also the modiﬁcation in the economy in
Mexico in 1983. The most dramatic increase in payment to employees could be
exposed for the extreme values in January 1974, October 1976 and January 1979.
The exchange rate devaluation presented in August 1982 and December 1982 are
also presented in Table 1. Due to the increase in gasoline prices the RBDM could
show outliers in December 1973, November 1974 and November 1976. Finally, we
think this random walk RBDM could be useful not only to accounting changes in this
economic time series but also may be useful as an pre-intervention dynamic model.

4 The case of Puerto Rico

3

0.8
0.4
3
2

0.0

0.4

ω y, t

0.8

1.2

−1

0

1

Residuals

4

5

6

0.0

ωθ, t

1.2

1

2

States

4

5

In this section we use the linear trend RBDM presented in (6) and a linear trend
RBDM with a seasonal component in order to model the logarithm of CPI, AEI and
total number of employments (TNE) from January 1980 to December 2012 in
Puerto Rico. The CPI and Economic Activity Index (EAI) are two economic

1970

1972

1974

1976

1978

1980

1982

Fig. 2 Outliers and structural breaks in CPI-variations from Mexico 1969–1983. The right scale is for the
Page 7 of 17 6

Month/year

Eðxy;t jy1:T Þ

Jul 1973

0.8118393

Dec 1973

0.18126535

Jan 1974

0.24155247

Nov 1974

0.30013551

Oct 1976

0.11182539

Nov 1976

0.30769569

Jan 1979

0.14002184

Jan 1980

0.08193927

Aug 1982

0.02124920

Dec 1982

0.02747282

Jan 1983

0.02584617

indexes widely used for describing the economic situation of Puerto Rico. The CPI
and EAI are useful for accounting the inﬂation through of price ﬂuctuations and the
real economic activity. EAI and TNE are very correlated in the sense that EAI is
computed by using also TNE. However TNE is an interesting time series for the
quarterly seasonal component and also for the historic fact that in Puerto Rico in
July 2009 near of 17,000 employments lost their jobs for the recent economic crisis.
We ﬁnd that by using RBDMs historical changes are detected as structural breaks in
the trend of the models.
Now we describe brieﬂy some of the important historical changes useful for the
interpretation of the results.
4.1 CPI historical changes
A ﬁrst index for accounting the inﬂation in Puerto Rico was born by using the cost
of living for working families in 1940. The CPI was born in 1977 by including in the
ﬁrst index information on urban families, self-employed and the pensioners in
Puerto Rico. Using addition products, in 1990 a few adjustments to items and
services of CPI were proposed. A new study of Income and Expenses was made in
the years 1999–2003 with a major change in the CPI methodology in March 2010.
Currently, the basket of goods for CPI has the following major groups: food and
beverages, housing, apparel, transportation, medical care, entertainment, education
and communication and those groups are similar to the United States basket (see for
example Department of labor and human resources 2008).
4.2 EAI historical changes
The monthly EAI includes the behavior of four economic indicators: total number of
employments (thousands), cement sales (million bags), fuel consumption (millions
of gallons) and electricity generation (million KWH). According to the Government
the indicators useful for detecting recession periods in the economy of Puerto Rico
during the last 35 years have been: 1980–1982, 1990–1991, 2001–2002 and since
2006.
Due to the quarterly seasonal component in TNE (see Fig. 3) we use a local trend
with a seasonal component in this economic variable. The observation and system
matrices of this model are:
3
2
1 1
0
0
0
7
6
0
0
0 7
60 1
7
6
F ¼ ½ 1 0 1 0 0  G ¼ 6 0 0 À 1 À 1 À 1 7;
7
6
7
6
1
0
0 5
40 0
0 0
0
1
0
and the unknown parameters are the observations variance Vt and three elements for
Wt :
Â
Ã
Wt ¼ r2 ; r2 ; r2 ; 0; 0
l;t
s;t
n;t

TNE

90

800000

CPI

80

900000

1000000

110
100

150
140
130
120
90

60

700000

100

70

110

EAI

1100000

where r2 , r2 and r2 are the unknown variances of the level of the series, the
l;t
s;t
n;t
slope of the linear trend and the seasonal respectively.
Figure 4 displays the results by using CPI for the period of January 1980–
December 2012. The residuals in bottom of Fig. 4 are given by
^
t ¼ yt À EðFht jy1:T Þ. By looking at the residuals there are no outliers. The slope
is dynamically changing with only a sudden jump within the ﬁrst recession period in
September 1981.
Table 2 show how the trend has different jumps, the most dramatic one in
September 2005 with Eðxh;t1 jy1:T Þ ¼ 0:07 and some other abrupt changes in the
precedent years. Even though the CPI is an indicator of inﬂation, this dramatic
change could have been an ‘‘alarm’’ for the economic recession Puerto Rico is

1980 1985 1990 1995 2000 2005 2010

1980 1985 1990 1995 2000 2005 2010

Time

Time

Fig. 3 Economic time series from Puerto Rico: EAI, CPI and TNE

123

0

100

200

0.6
0.0

0.008
0.004

0.6
0.02
0.00

0.0

0.6

ωy, t

1.2

−0.02

Residuals

0.0

ωθ2, t

1.2

0.000

Slope

ωθ1, t

1.2

4.0

Trend

4.6

Lat Am Econ Rev (2015) 24:6

1980

1985

1990

1995

2000

2005

2010

Fig. 4 Outliers and structural breaks in the logarithm monthly Consumer Price Index in Puerto Rico. The
right scale is for the latent xy;t and xh;ti parameters. Red points illustrate the outliers and structural breaks
(color ﬁgure online)

facing since 2006. Other dramatic changes are found in May 1980, July 1989 and
September 1990, all of them within of recession periods in Puerto Rico.
The structural break in 1980 likely is due to changes in the methodology for
computing the CPI. The change in the trend of the CPI at the years 1989 and 1990
could also be related to the implementation of the ‘‘Joint Committee on Taxation’’
in the United States, and its effect on the island. Figure 5 shows the abrupt changes
in the trend for the EAI.
In particular, two dramatic level changes are presented in September 1989 and
December 1989 in the beginning of the recession period of 1990. On the other hand
other structural breaks are showed in July 1996, September 1998, December 1998
and July 2005 probably related with the rest of recession periods.
Figure 6 illustrates the trend, slope and seasonal posterior component with their
corresponding credible intervals for TNE. An interesting feature by using RBDMs is
that the credible intervals are not of constant width. For the seasonal component the
95 % interval is wider for the structural changes. Figure 7 displays the relationship
between the time series for the recession periods. The abrupt changes in both
indexes during the last period may be the consequence of the economic crisis that
Lat Am Econ Rev (2015) 24:6

Month/year

Eðxh;t1 jy1:T Þ-CPI

May 1980

0.26805231

Mar 1986

0.45021372

Jul 1989

0.15716954

Sep 1990

0.25732717

Mar 1991

0.46168657

Jan 1992

0.35024676

Oct 1994

0.47112292

Jul 2001

0.41570839

Apr 2005

0.20405587

Sep 2005

0.07041677

Dec 2005

0.26448903

Apr 2006

0.25815601

May 2006

0.47095720

Dec 2006

0.12863052

Jun 2008

0.26322651

Nov 2008

0.10991814

Dec 2008

0.13796592

Jan 2009

0.43613370

Jun 2009

0.37176951
Eðxh;t1 jy1:T Þ-EAI

Jul 1980

0.4805507

Mar 1983

0.3128145

Dec 1987

0.4969033

Sep 1989

0.2555551

Dec 1989

0.2868322

Jan 1990

0.4662116

Jul 1996

0.2527494

Dec 1996

0.3596205

Sep 1998

0.1603856

Oct 1998

0.3832146

Nov 1998

0.2897125

Dec 1998

0.2202965

Dec 2001

0.4586847

Jul 2005

0.3384897
Eðxh;t1 jy1:T Þ-TNE

Aug 1989

0.4428376

Aug 1990

123

0.4871985


0.000

0.0

0.02
0.00

0.0

0.6

ωy, t

1.2

−0.02

Residuals

0.6

ωθ2, t

1.2

−0.010

Slope

0.010

0.6

ωθ1, t

1.2

4.5

4.7

4.9

Lat Am Econ Rev (2015) 24:6

1980

1985

1990

1995

2000

2005

2010

Fig. 5 Outliers and structural breaks in the logarithm monthly Economic Activity Index in Puerto Rico.
The right scale is for the latent xy;t and xh;ti parameters. Red points illustrate the outliers and structural
breaks (color ﬁgure online)

Rico 7816 public employments lost their jobs in July 2009 and the RBDM detects
this change in the bottom of Fig. 7.

5 Conclusions
In this paper we apply Robust Bayesian Dynamic Models (RMBDs) to LatinAmerican time series from Mexico and Puerto Rico. The classes of RMBDs
presented in this work with weakly-robust priors for the observation and state
variances consider most of the empirical models used in the classical econometrics
literature as random walk, linear trend, seasonal and a combination of those models.
We found that using RMBDs allow us to account historic outliers and structural
breaks in the inﬂation in Mexico and the economic recession periods in Puerto Rico.
In fact, the structural changes have a contextual historical and economical meaning.
Also, the model has the feature of producing not constant credible intervals over
time even after accounting for boundary effects in the Latin-American variables.
Finally we consider that in a future work new RMBDs could be implement to time

Trend

13.8

6 Page 12 of 17

1985

1990

1995

2000

2005

2010

1980

1985

1990

1995

2000

2005

2010

1980

1985

1990

1995

2000

2005

2010

−0.005

Seasonal

0.005

−0.005

Slope

0.005

1980

4.4

0.8
0.0
0.8
0.0
1980

1985

1990

1995

2000

2005

ωθ1, t

13.7

0.0

0.8

4.5 4.7 4.9
13.4

ωθ1, t

Trend−EAI
Trend−TNE

ωθ1, t

4.0

Trend−CPI

Fig. 6 Trend, slope and seasonal posterior mean parameters with their corresponding credible interval
for TNE

2010

Fig. 7 Comparison structural breaks for the monthly Consumer Price and Economic Indexes in Puerto
Rico. The right scale is for the latent xh;t1 parameter. Red points illustrate the outliers and structural
for dynamic volatility approaches in ﬁnance.
Lat Am Econ Rev (2015) 24:6
DOI 10.1007/s40503-015-0020-z

A robust Bayesian dynamic linear model
for Latin-American economic time series: ‘‘the Mexico
and Puerto Rico cases’’
´
´quene1 • Marta Alvarez2 • Luis Raul Pericchi3
´
Jairo Fu

Received: 29 August 2014 / Revised: 23 May 2015 / Accepted: 1 July 2015 /
Published online: 28 July 2015
Ó The Author(s) 2015. This article is published with open access at Springerlink.com

Abstract The traditional time series methodology requires at least a preliminary
transformation of the data to get stationarity. On the other hand, robust Bayesian
dynamic models (RBDMs) do not assume a regular pattern or stability of the
underlying system but can include points of statement breaks. In this paper we use
RBDMs in order to account possible outliers and structural breaks in Latin-American economic time series. We work with important economic time series from
Puerto Rico and Mexico. We show by using a random walk model how RBDMs can
be applied for detecting historic changes in the economic inﬂation of Mexico. Also,
we model the Consumer Price Index, the Economic Activity Index and the total
number of employments economic time series in Puerto Rico using local linear
trend and seasonal RBDMs with observational and states variances. The results
illustrate how the model accounts the structural breaks for the historic recession
periods in Puerto Rico.
Keywords Robust Bayesian dynamic model Á Outliers and structural breaks Á
Latin-American time series Á Consumer Price Index Á Economic Activity Index Á
Total number of employments
JEL Classiﬁcation

C11 Á C40 Á G17 Á N16

´
& Jairo Fuquene
J.A.Fuquene-Patino@warwick.ac.uk
1

Department of Statistics, University of Warwick, Coventry, UK

2

Institute of Statistics, Business School, University of Puerto Rico, Rio Piedras, Puerto Rico

3

Economic Latin-American time series variables can be complex with high
frequency data. From a frequentist perspective, techniques for ﬁtting time series
models use a preliminary data-set transformation in order to get stationarity and
therefore important information about the dynamic system can be lost. On the other
hand, from a Bayesian perspective the use of RBDMs with weakly-robust priors for
the observation and state variances has been revolutionary in recent years due to
ﬂexibility for detecting outliers and structural breaks, the straightforward computational techniques based in Markov Chain Monte Carlo (MCMC) and the natural
update from Bayes theorem without a preliminary data-set transformation.
From a frequentist perspective the study of time series with structural changes
has been of far reaching in econometric theory for univariate time series, frequentist
dynamic models, volatility and even ﬁnancial return models. The seminal paper of
Tsay (1988) considers least square techniques and residual variance ratios for
detecting outliers, level shifts and variance changes in univariate time series.
Hansen (2000) introduces a bootstrap method for detecting structural changes in
regressors including structural shifts, polynomial trends and exogenous stochastic
trends for frequentist dynamic econometric models. For volatility models, Vladimir
(2009) uses local chance point analysis to intervals of homogeneity in order to
account possible structural breaks. Fryzlewicz and Rao (2013) propose a method
based in process transformation and binary segmentation for detecting multiple
change points in auto-regressive conditional heteroscedastic models for ﬁnancial
returns.
From a Bayesian perspective in recent years RBDMs for detecting structural
breaks have been proposed as an alternative to the usual Bayesian dynamic models.
Ardia and Hoogerheide (2010) propose a Bayesian generalized autoregressive
conditional heteroscedasticity dynamic model with Student-t innovations with
applications to the R program (R Development Core Team 2015). Polson and Scott
(2011) apply heavy-tailed priors in order to examine historical patterns of return on
´
assets to ﬁnancial time series. Fuquene et al. (2014) propose a new ﬂexible class of
heavy-tailed priors for detecting outliers and structural breaks in Bayesian dynamic
linear models.
However, even though the qualities of RBDMs in the best of our knowledge there
are no application of RBDMs to economic Latin-American variables for detecting
their historic outliers and structural breaks. Therefore, in this work we use the
´
RBDMs proposed by Fuquene et al. (2014) to modelling the historic change points
in Latin-American economic variables from Mexico and Puerto Rico. We use this
methodology because: (1) we can model a considerable variety of dynamic models:
random walk, local linear trend and seasonal or a combination of those models with
weakly-robust priors for the observation and state variances, (2) the computational
schemes can be applied easily for practitioners and (3) using RBDMs allows us to
have posterior inference for the parameters from a Bayesian perspective.
The paper is organized as follows: Section 2 shows the prior variances
in the inﬂation of this country. Section 4 shows local trend and stationary RBDMs
for accounting the abrupt changes in the economic recession periods in Puerto Rico.
Finally we have the conclusions in Sect. 5.

2 Model speciﬁcation
The dynamic linear model (DLM) is speciﬁed (see West and Harrison 1997) by a
Normal prior distribution for the p-dimensional state vector at t ¼ 0 as follows:
h0 $ Np ðm0 ; C0 Þ;

ð1Þ

with the set of equations:
y t ¼ F t ht þ m t
ht ¼ Gt htÀ1 þ xt

mt $ Nm ð0; Vt Þ;
xt $ Np ð0; Wt Þ;

ð2Þ
ð3Þ

with t ¼ 1 : T and where Ft and Gt are known matrices of order p Â p and m Â p
respectively. With mt and xt two independent Gaussian random vectors with mean
zero and known variance Vt and Wt respectively. The observation equation and
state equation are (2) and (3), respectively. A set of prior distributions for the
observation and state variances may be considered in practice. For example in
order to have closed form full conditionals we could use gamma prior densities.
However, in the presence of highly frequency data heavy-tailed priors are the best
alternative. The scaled Beta2 prior for the precision k ¼ 1=s2 is proposed in
´
Fuquene et al. (2014) for modelling the variances (and precisions) in DLMs and
deﬁned as follows:
pðkÞ ¼

Cðq þ pÞ
ðbkÞqÀ1
b
;
CðqÞCðpÞ ð1 þ bkÞpþq

k[0

ð4Þ

where b is the scale parameter. This paper considers the Student-t density coupled
´
with a scaled Beta2 for modelling the observation and state errors (as in Fuquene
et al. 2014) in Latin-American economic time series from Mexico and Puerto Rico.
So, let h $ be a Student-t ðl; s; tÞ where t are the degrees of freedom, l the location
and s the scale of the Student-t density:

 !Àðtþ1Þ=2
k1
1 hÀl 2
2
1þ
pðhjs Þ ¼
; t [ 0; À1\l\1; À1\h\1;
t
s
s
ð5Þ
R1
Cððt þ 1Þ=2Þ
pﬃﬃﬃﬃﬃ . We have that pðhÞ ¼ 0 pðhjs2 Þpðs2 Þds2 and therefore
Cðt=2Þ vp
the marginal prior as follows:

Lat Am Econ Rev (2015) 24:6

bq m=ðh À lÞqþ1=2 2F1ðp þ q; q þ 1=2; ðt þ 1Þ=2 þ p þ q; 1 À bm=ðh À lÞ2 Þ
k1 Beðq þ 1=2; p þ v=2Þ=Beðp; qÞ

if h 6¼ l;
if h ¼ l;

with 2F1(a, b, c, z) the hypergeometric function (see 15.1.1 of Abramowitz and
´
Stegun 1970) and we have that pðhÞ is the Student-t-Beta(t; p; q; b) (see Fuquene
et al. 2014 for the proof of this result). The variances of the RBDM are Student-t1
Betaðt; q; p; bÞ densities (with the Beta2 prior for the precision as k ¼ 1=s2 ). Here
Wt;i denotes the ith diagonal element of Wt;i , i ¼ 1; . . .; n the hierarchical Student-t1
Beta(t; q; p; b) prior can be summarized as follows:
VtÀ1 ¼ ky xy;t ;

À1
Wt;i ¼ kh;i xh;ti ;

ky jq $ Gammaðq; ðbqy ÞÀ1 Þ;

kh;i jq $ Gammaðq; ðbqh;ti ÞÀ1 Þ;

xy;t $ Gammaðt=2; 2=tÞ; xh;ti $ Gammaðt=2; 2=tÞ;
qy $ Gammaðp; 1Þ; qh;ti $ Gammaðp; 1Þ;
For each t, the posterior distribution of the latent variables xy;t and xh;ti is useful in
order to account the outliers and abrupt changes in the economic time series. Values
of xy;t and xh;ti smaller than one indicate possible outliers or abrupt changes
respectively. A Gibbs sampler scheme can be implemented by using the full conditional in closed form of RBDMs (see Appendix 1).
2.1 Illustration RBDM with a toy example: the annual CPI from Puerto
Rico
We consider now the annual Consumer Price Index (CPI) in Puerto in the log-scale
in order to illustrate how a RBDM works. We use a local linear trend model (i.e.,
linear growth model) for ﬁtting the trend and slope of the Consumer CPI in
logarithm scale as follows:
yt ¼ lt þ mt ;

mt $ Nð0; Vt Þ;

lt ¼ ltÀ1 þ ntÀ1 þ xt;1 ; xt;1 $ Nð0; Wt;1 Þ;
nt ¼ ntÀ1 þ xt;2 ; xt;2 $ Nð0; Wt;2 Þ;
with uncorrelated errors mt , xt;1 and xt;2 and where
" 2
#
!
!
rl;t 0
lt
1 1
ht ¼
; Wt ¼
; G¼
;
0 1
nt
0 r2
n;t

F ¼ ½1

ð6Þ

0 :

For this toy example we use a Student-t-Beta2 where p ¼ q ¼ 1, and 1=b ¼
10;000 as is proposed in Pericchi and Perez (2010). We have convergence of all
parameters using 10,000 iterations after a burn-in phase period of 5000 iterations.
Figure 1 displays how by using the RBDM an outlier in the year 2000 is obtained.
The changes in the trend shows the level changes in 1990 and 2001 and the slope
In this section we use a random walk RBDM in order to detect outliers and
structural breaks of the inﬂation in Mexico. We use the monthly logarithm of the
CPI-variations from 1696 to 1983 in order to accounting possible changes in
inﬂation in Mexico during this period such as: (1) The monetary devaluation in 1976
and 1982. (2) The value-added tax imposed in 1980 with the posterior modiﬁcation
in 1983. (3) Some changes in the payment to employees and the increase in gasoline
prices and (4) The modiﬁcation in the economy in Mexico in 1983. The random
walk model RBDM can be written as follows:
y t ¼ ht þ m t ;

mt $ Nð0; Vt Þ;

ht ¼ htÀ1 þ xt ;

ð7Þ

xt;1 $ Nð0; Wt Þ;

0.6
0.6
0.005

0.6
0.0

ωy, t

1.2

−0.005

Residuals

0.0

ωθ2, t

1.2

Slope

0.015 0.025 0.035

0.0

ωθ1, t

1.2

Trend

with the prior speciﬁcation showed in previous Section. We implement the Gibbs
sampling scheme showed in Appendix 1 and from a visual assessment of the Gibbs
output we have that convergence has been achieved in Appendix 2. The ergodic
means are nonetheless pretty stable in the middle of the plots and the decay of the
empirical autocorrelation function is very fast.

1985

1990

1995

2000

2005

2010

Fig. 1 Outliers and structural breaks in the annual logarithm Consumer Price Index in Puerto Rico using
September 1976 and January 1982. These changes likely represent the exchange rate
devaluation in September 1976 and just one month before of the second devaluation
in 1982. On the other hand, in Table 1 the expectations for the latent parameters for
identifying the outliers in the random walk RBDM are presented. The outliers in
January 1980 and January 1983 probably showed the value-added tax imposed and
consequently modiﬁed in those dates with also the modiﬁcation in the economy in
Mexico in 1983. The most dramatic increase in payment to employees could be
exposed for the extreme values in January 1974, October 1976 and January 1979.
The exchange rate devaluation presented in August 1982 and December 1982 are
also presented in Table 1. Due to the increase in gasoline prices the RBDM could
show outliers in December 1973, November 1974 and November 1976. Finally, we
think this random walk RBDM could be useful not only to accounting changes in this
economic time series but also may be useful as an pre-intervention dynamic model.

4 The case of Puerto Rico

3

0.8
0.4
3
2

0.0

0.4

ω y, t

0.8

1.2

−1

0

1

Residuals

4

5

6

0.0

ωθ, t

1.2

1

2

States

4

5

In this section we use the linear trend RBDM presented in (6) and a linear trend
RBDM with a seasonal component in order to model the logarithm of CPI, AEI and
total number of employments (TNE) from January 1980 to December 2012 in
Puerto Rico. The CPI and Economic Activity Index (EAI) are two economic

1970

1972

1974

1976

1978

1980

1982

Fig. 2 Outliers and structural breaks in CPI-variations from Mexico 1969–1983. The right scale is for the
Page 7 of 17 6

Month/year

Eðxy;t jy1:T Þ

Jul 1973

0.8118393

Dec 1973

0.18126535

Jan 1974

0.24155247

Nov 1974

0.30013551

Oct 1976

0.11182539

Nov 1976

0.30769569

Jan 1979

0.14002184

Jan 1980

0.08193927

Aug 1982

0.02124920

Dec 1982

0.02747282

Jan 1983

0.02584617

indexes widely used for describing the economic situation of Puerto Rico. The CPI
and EAI are useful for accounting the inﬂation through of price ﬂuctuations and the
real economic activity. EAI and TNE are very correlated in the sense that EAI is
computed by using also TNE. However TNE is an interesting time series for the
quarterly seasonal component and also for the historic fact that in Puerto Rico in
July 2009 near of 17,000 employments lost their jobs for the recent economic crisis.
We ﬁnd that by using RBDMs historical changes are detected as structural breaks in
the trend of the models.
Now we describe brieﬂy some of the important historical changes useful for the
interpretation of the results.
4.1 CPI historical changes
A ﬁrst index for accounting the inﬂation in Puerto Rico was born by using the cost
of living for working families in 1940. The CPI was born in 1977 by including in the
ﬁrst index information on urban families, self-employed and the pensioners in
Puerto Rico. Using addition products, in 1990 a few adjustments to items and
services of CPI were proposed. A new study of Income and Expenses was made in
the years 1999–2003 with a major change in the CPI methodology in March 2010.
Currently, the basket of goods for CPI has the following major groups: food and
beverages, housing, apparel, transportation, medical care, entertainment, education
and communication and those groups are similar to the United States basket (see for
example Department of labor and human resources 2008).
4.2 EAI historical changes
The monthly EAI includes the behavior of four economic indicators: total number of
employments (thousands), cement sales (million bags), fuel consumption (millions
of gallons) and electricity generation (million KWH). According to the Government
the indicators useful for detecting recession periods in the economy of Puerto Rico
during the last 35 years have been: 1980–1982, 1990–1991, 2001–2002 and since
2006.
Due to the quarterly seasonal component in TNE (see Fig. 3) we use a local trend
with a seasonal component in this economic variable. The observation and system
matrices of this model are:
3
2
1 1
0
0
0
7
6
0
0
0 7
60 1
7
6
F ¼ ½ 1 0 1 0 0  G ¼ 6 0 0 À 1 À 1 À 1 7;
7
6
7
6
1
0
0 5
40 0
0 0
0
1
0
and the unknown parameters are the observations variance Vt and three elements for
Wt :
Â
Ã
Wt ¼ r2 ; r2 ; r2 ; 0; 0
l;t
s;t
n;t

TNE

90

800000

CPI

80

900000

1000000

110
100

150
140
130
120
90

60

700000

100

70

110

EAI

1100000

where r2 , r2 and r2 are the unknown variances of the level of the series, the
l;t
s;t
n;t
slope of the linear trend and the seasonal respectively.
Figure 4 displays the results by using CPI for the period of January 1980–
December 2012. The residuals in bottom of Fig. 4 are given by
^
t ¼ yt À EðFht jy1:T Þ. By looking at the residuals there are no outliers. The slope
is dynamically changing with only a sudden jump within the ﬁrst recession period in
September 1981.
Table 2 show how the trend has different jumps, the most dramatic one in
September 2005 with Eðxh;t1 jy1:T Þ ¼ 0:07 and some other abrupt changes in the
precedent years. Even though the CPI is an indicator of inﬂation, this dramatic
change could have been an ‘‘alarm’’ for the economic recession Puerto Rico is

1980 1985 1990 1995 2000 2005 2010

1980 1985 1990 1995 2000 2005 2010

Time

Time

Fig. 3 Economic time series from Puerto Rico: EAI, CPI and TNE

123

0

100

200

0.6
0.0

0.008
0.004

0.6
0.02
0.00

0.0

0.6

ωy, t

1.2

−0.02

Residuals

0.0

ωθ2, t

1.2

0.000

Slope

ωθ1, t

1.2

4.0

Trend

4.6

Lat Am Econ Rev (2015) 24:6

1980

1985

1990

1995

2000

2005

2010

Fig. 4 Outliers and structural breaks in the logarithm monthly Consumer Price Index in Puerto Rico. The
right scale is for the latent xy;t and xh;ti parameters. Red points illustrate the outliers and structural breaks
(color ﬁgure online)

facing since 2006. Other dramatic changes are found in May 1980, July 1989 and
September 1990, all of them within of recession periods in Puerto Rico.
The structural break in 1980 likely is due to changes in the methodology for
computing the CPI. The change in the trend of the CPI at the years 1989 and 1990
could also be related to the implementation of the ‘‘Joint Committee on Taxation’’
in the United States, and its effect on the island. Figure 5 shows the abrupt changes
in the trend for the EAI.
In particular, two dramatic level changes are presented in September 1989 and
December 1989 in the beginning of the recession period of 1990. On the other hand
other structural breaks are showed in July 1996, September 1998, December 1998
and July 2005 probably related with the rest of recession periods.
Figure 6 illustrates the trend, slope and seasonal posterior component with their
corresponding credible intervals for TNE. An interesting feature by using RBDMs is
that the credible intervals are not of constant width. For the seasonal component the
95 % interval is wider for the structural changes. Figure 7 displays the relationship
between the time series for the recession periods. The abrupt changes in both
indexes during the last period may be the consequence of the economic crisis that
Lat Am Econ Rev (2015) 24:6

Month/year

Eðxh;t1 jy1:T Þ-CPI

May 1980

0.26805231

Mar 1986

0.45021372

Jul 1989

0.15716954

Sep 1990

0.25732717

Mar 1991

0.46168657

Jan 1992

0.35024676

Oct 1994

0.47112292

Jul 2001

0.41570839

Apr 2005

0.20405587

Sep 2005

0.07041677

Dec 2005

0.26448903

Apr 2006

0.25815601

May 2006

0.47095720

Dec 2006

0.12863052

Jun 2008

0.26322651

Nov 2008

0.10991814

Dec 2008

0.13796592

Jan 2009

0.43613370

Jun 2009

0.37176951
Eðxh;t1 jy1:T Þ-EAI

Jul 1980

0.4805507

Mar 1983

0.3128145

Dec 1987

0.4969033

Sep 1989

0.2555551

Dec 1989

0.2868322

Jan 1990

0.4662116

Jul 1996

0.2527494

Dec 1996

0.3596205

Sep 1998

0.1603856

Oct 1998

0.3832146

Nov 1998

0.2897125

Dec 1998

0.2202965

Dec 2001

0.4586847

Jul 2005

0.3384897
Eðxh;t1 jy1:T Þ-TNE

Aug 1989

0.4428376

Aug 1990

123

0.4871985


0.000

0.0

0.02
0.00

0.0

0.6

ωy, t

1.2

−0.02

Residuals

0.6

ωθ2, t

1.2

−0.010

Slope

0.010

0.6

ωθ1, t

1.2

4.5

4.7

4.9

Lat Am Econ Rev (2015) 24:6

1980

1985

1990

1995

2000

2005

2010

Fig. 5 Outliers and structural breaks in the logarithm monthly Economic Activity Index in Puerto Rico.
The right scale is for the latent xy;t and xh;ti parameters. Red points illustrate the outliers and structural
breaks (color ﬁgure online)

Rico 7816 public employments lost their jobs in July 2009 and the RBDM detects
this change in the bottom of Fig. 7.

5 Conclusions
In this paper we apply Robust Bayesian Dynamic Models (RMBDs) to LatinAmerican time series from Mexico and Puerto Rico. The classes of RMBDs
presented in this work with weakly-robust priors for the observation and state
variances consider most of the empirical models used in the classical econometrics
literature as random walk, linear trend, seasonal and a combination of those models.
We found that using RMBDs allow us to account historic outliers and structural
breaks in the inﬂation in Mexico and the economic recession periods in Puerto Rico.
In fact, the structural changes have a contextual historical and economical meaning.
Also, the model has the feature of producing not constant credible intervals over
time even after accounting for boundary effects in the Latin-American variables.
Finally we consider that in a future work new RMBDs could be implement to time

Trend

13.8

6 Page 12 of 17

1985

1990

1995

2000

2005

2010

1980

1985

1990

1995

2000

2005

2010

1980

1985

1990

1995

2000

2005

2010

−0.005

Seasonal

0.005

−0.005

Slope

0.005

1980

4.4

0.8
0.0
0.8
0.0
1980

1985

1990

1995

2000

2005

ωθ1, t

13.7

0.0

0.8

4.5 4.7 4.9
13.4

ωθ1, t

Trend−EAI
Trend−TNE

ωθ1, t

4.0

Trend−CPI

Fig. 6 Trend, slope and seasonal posterior mean parameters with their corresponding credible interval
for TNE

2010

Fig. 7 Comparison structural breaks for the monthly Consumer Price and Economic Indexes in Puerto
Rico. The right scale is for the latent xh;t1 parameter. Red points illustrate the outliers and structural
for dynamic volatility approaches in ﬁnance.
Acknowledgments We thank to the associated editor and the two referees by detailed comments and
suggestions that greatly improved the quality of this paper. Also, we thank to Brenda Betancourt (UCSC)
and Javier Rubio (Warwick) for the discussions with the ﬁrst author which were very useful in preparing
´
´
the last version of this paper. Jairo Fuquene and Marta Alvarez were supported by the grant PII-2012,
Business School, University of Puerto Rico, Rio Piedras.
Open Access This article is distributed under the terms of the Creative Commons Attribution 4.0
International License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original
author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were
made.

Appendix 1: Prior distributions and Markov Chain Monte Carlo
algorithm
The scaled Beta2 distribution can be deﬁned as a scale mixture of Gammas for the
square of the scale as follows:
s2 $ Gammaðp; b=qÞ

ð8Þ

q $ Gammaðq; 1Þ

ð9Þ

where Gamma(a, b) denotes the Gamma distribution:
pðxja; bÞ ¼

1
xaÀ1 expfÀx=bg
CðaÞba

a [ 0; b [ 0;

ð10Þ

with b the scale parameter. Therefore the scaled Beta2 prior for the square scale is
the following:
 2 pÀ1
s
Cðp þ qÞ 1
b
ð11Þ
pðs2 Þ ¼

pþq : s [ 0:
CðpÞCðqÞ b
s2
1þ
b
For precisions k ¼ 1=s2 , we assign the scaled Beta2 as
pðkÞ ¼

Cðq þ pÞ
ðbkÞqÀ1
b
;
CðqÞCðpÞ ð1 þ bkÞpþq

k [ 0;

ð12Þ

typically the hyper-parameters p, q are fairly small, for example p ¼ q ¼ 1, and b
quite small (see Pericchi and Perez 2010) obtaining a bounded density at the origin,
yt ¼ Ft ht þ mt mt $ Nm ð0; Vt Þ;
ht ¼ Gt htÀ1 þ xt xt $ Np ð0; Wt Þ;

ð13Þ

where the observation and state variances are given by:
VtÀ1 ¼ ky xy;t ;

À1
Wt;i ¼ kh;i xh;ti ;

ky jq $ Gammaðq; ðbqy ÞÀ1 Þ;
xy;t $ Gammaðt=2; 2=tÞ;
qy $ Gammaðp; 1Þ;

kh;i jq $ Gammaðq; ðbqh;ti ÞÀ1 Þ;
xh;ti $ Gammaðt=2; 2=tÞ;

qh;ti $ Gammaðp; 1Þ;

In order to obtain posterior inference on the state parameters h1 ; . . .; hT , we use the
forward ﬁltering backward sampling (FFBS) given in Fruwirth-Schnatter (1994)
which is practically a simulation of the smoothing recursions. The FFBS works as
follows:
1.

Use the Kalman Filter equations for (5). Let m0 and C0 (known) with
ðh0 jD0 Þ $ Nðm0 ; C0 Þ and
ht jy1:tÀ1 $ NðmtÀ1 ; CtÀ1 Þ

•

The one step predictive distribution of ht given y1:tÀ1 is Gaussian
ðht jDtÀ1 Þ $ Nðat ; Rt Þ with parameters:
at ¼ Gt mtÀ1 ;

•

0

ð15Þ

Rt ¼ Gt CtÀ1 Gt :

The one step predictive distribution of yt given y1:tÀ1 is Gaussian
ðyt jDtÀ1 Þ $ Nðft ; Qt Þ with parameters:
0

ft ¼ Ft at ;
•

ð14Þ

0

Qt ¼ Ft Rt Ft þ Vt :

The ﬁltering distribution of ht given y1:tÀ1 is Gaussian ðht jDt Þ $ Nðmt ; Ct Þ
with parameters:
mt ¼ at þ At et ;

0

ð16Þ

Ct ¼ Rt À At Qt At

where At ¼ Rt Ft QÀ1 , and et ¼ yt À ft .
t
2.
3.

At time t ¼ T sample hT from NðhT jmt ; Ct Þ.
For t ¼ ðT À 1Þ : 0 sample ht from Nðht jmÃ ; CtÃ Þ with
t
mÃ ¼ mt þ Bt ðhtþ1 À atþ1 Þ
t
0

where Bt ¼ Ct Gtþ1 RÀ1 .
tþ1

123

observation and state variances we use the standard approach by considering the full
conditional distribution proportional to the joint distribution of all random variables
(parameters) considered. So, for example using (13) the full conditional for ky is
given by:
&
'
T
Y
È
É
ky xy;t
2
1=2
qÀ1
ð17Þ
pðky j. . .Þ /
ðyt À Ft ht Þ Á ky exp Àbqy ky ;
ky exp À
2
t¼1
hence,


T 1
ky j. . . $ Gamma q þ ; SSyÃ þ bqy
2 2
where SSyÃ ¼
given by:

PT

t¼1

ð18Þ

xy;t ðyt À Ft ht Þ2 . The rest of full conditional distributions are


T 1
ky j. . . $ Gamma q þ ; SSyÃ þ bqy ;
2 2


T 1 Ã
kh;i j. . . $ Gamma q þ ; SSh;i þ bqh;ti
2 2

where SSÃ ¼
h;i

PT

xh;ti ðhti À ðGt htÀ1 Þi Þ2 for i ¼ 1; 2; . . .; p;
!
t þ 1 t þ ky ðyt À Ft ht Þ2
;
xy;t j. . . $ Gamma
;
2
2
t¼1

t þ 1 t þ ky ðhti À kh;i ðGt htÀ1 Þi Þ2
;
xh;ti j. . . $ Gamma
2
2
À
Á
qy j. . . $ Gamma p þ q; bky þ 1 ;

!

À
Á
qh;ti j. . . $ Gamma p þ q; bkh;i þ 1 ;

Appendix 2: Convergence of parameters for the Mexico case

0.55
0.25

0.0

0.30

0.16

0.2

0.4

ACF

0.18

ergMean

0.6

0.20

0.50
0.45
0.35

0.40

λy
1

1.0

6 Page 16 of 17

1000

2000

3000

0

1000

2000

3000

0

1000

2000

3000

0

1000

2000

3000

0 5

25

35

0 5

15

25

35

0.18

0.35

0.12

0.4

ACF

0.14

ergMean

0.6

0.16

0.8

0.30
0.25
0.20
0.05

0.0

0.10

0.10

0.2

0.15

1 λθ, t

15

1.0

0

Fig. 8 Convergence diagnostic plots for the constant precision parameters of CPI-variations from
Mexico 1969–1983. Left histograms for the precisions. Middle ergodic mean. Right autocorrelation plots

37:1405–1436
